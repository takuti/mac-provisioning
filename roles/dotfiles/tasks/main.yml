---

- name: create ghq directory
  file: path={{ dotfiles }} state=directory owner={{ ansible_user_id }} group=staff mode=0755

- name: clone dotfiles repository
  git: repo={{ repository }} dest={{ dotfiles }}

- name: create .oh-my-zsh
  file: path=/Users/{{ ansible_user_id }}/.oh-my-zsh state=directory owner={{ ansible_user_id }} group=staff mode=0755

- name: install oh-my-zsh
  shell: curl -L https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh | sh

- name: create links
  file: src={{ item.src }} dest={{ item.dest }} state=link force=true
  with_items: '{{ links }}'
  ignore_errors: true

- name: add path of zsh to /etc/shells
  lineinfile: dest=/etc/shells line=/usr/local/bin/zsh state=present owner=root group=wheel mode=0644
  become: yes

- name: change shell to zsh
  shell: chsh -s /usr/local/bin/zsh
  become: no

- name: write profile of iterm2
  command: defaults write com.googlecode.iterm2 PrefsCustomFolder -string '{{ dotfiles }}/iterm2'
